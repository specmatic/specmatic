<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="assets/preflight.css">
    <link rel="stylesheet" href="assets/styles.css">
    <title>[[${pageTitle}]]</title>
</head>

<body>
    <header>
        <div id="branding">
            <img src="assets/specmatic-logo.svg" alt="Specmatic Logo" />
            <h1>[[${reportHeading}]]</h1>
            <button id="print">
                <img src="assets/download.svg" alt="Print Button" />
            </button>
        </div>
        <div id="summary" th:class="'bg-' + ${summaryResult}" data-panel="table">
            <div id="coverage">
                <span>API Coverage</span>
                <span th:class="${summaryResult}">[[${totalCoverage}]]%</span>
            </div>
            <ol id="test-counts" data-filter="All">
                <li id="Success">
                    <img src="assets/check-badge.svg" alt="success-count" />
                    <span>Success: </span>
                    <span>[[${totalSuccess}]]</span>
                </li>
                <li id="Failed">
                    <img src="assets/x-circle.svg" alt="failed-count" />
                    <span>Failed: </span>
                    <span>[[${totalFailures}]]</span>
                </li>
                <li id="Error">
                    <img src="assets/exclamation-triangle.svg" alt="success-count" />
                    <span>Errors: </span>
                    <span>[[${totalErrors}]]</span>
                </li>
                <li id="Skipped">
                    <img src="assets/blocked.svg" alt="success-count" />
                    <span>Skipped: </span>
                    <span>[[${totalSkipped}]]</span>
                </li>
                <li class="active" id="All">
                    <img src="assets/clipboard.svg" alt="success-count" />
                    <span>Total: </span>
                    <span>[[${totalTests}]]</span>
                </li>
            </ol>
            <div id="badge">
                <img src="assets/badge.svg" alt="Result Badge" th:class="${summaryResult}" />
                <img th:src="'assets/mark-' + ${summaryResult} + '.svg'" alt="Result Mark" id="mark" />
            </div>
        </div>
        <ul id="additional-info">
            <li>
                <p>Generated On <span>[[${generatedOn}]]</span></p>
            </li>
            <li>
                <p>Actuator <span>[[${actuatorEnabled == true ? 'Enabled' : 'Disabled'}]]</span></p>
            </li>
            <li th:if="${successCriteriaPassed == false}">
                <p>Success Criteria Failed: <span class="rejected">Minimum API Coverage of [[${minimumCoverage}]]% was not met.</span></p>
            </li>
        </ul>
    </header>
    <main class="group" data-panel="table">
        <table id="reports" data-filter="All">
            <thead>
                <tr>
                    <td>Coverage</td>
                    <td th:each="column: ${tableColumns}" th:attr="colspan=${column.colSpan}" th:text="${column.name}"></td>
                    <td>Exercised</td>
                    <td>Result</td>
                </tr>
            </thead>
            <tbody>
                <tr th:each="row : ${tableRows}" th:attr="data-type=${row.htmlResult}, data-color=${row.badgeColor}">
                    <td th:text="${row.coveragePercentage} + '%'" th:classappend="${row.groups[0].showRow} ? '' : 'hidden'"
                        th:attr="rowspan=${row.groups[0].rowSpan}, data-main=${row.groups[0].showRow}"></td>
                    <td th:each="group,iter: ${row.groups}" th:classappend="${group.showRow} ? '' : 'hidden'"
                        th:attr="rowspan=${group.rowSpan}, colspan=${tableColumns[iter.index].colSpan}, data-main=${group.showRow}, data-colName=${group.columnName}"
                        th:text="${group.value}">
                    </td>
                    <td th:text="${row.exercised}"></td>
                    <td><span class="pill" th:classappend="${row.badgeColor}" th:text="${row.result}"></span></td>
                </tr>
            </tbody>
        </table>
        <div id="details">
            <div id="group-details">
                <button id="back">
                    <span>&larr;</span>
                    <span>Go Back</span>
                </button>
                <ul id="group-summary">
                </ul>
                <div id="sort" data-expand="false" data-sort="scenario type" data-order="asc">
                    <img src="assets/sort.svg" alt="Sort Button" />
                    <p>Scenario Type</p>
                    <img src="assets/chevron-down.svg" alt="expand" />
                    <ol id="sort-select">
                        <li data-sort="result" >
                            <span>Result</span>
                        </li>
                        <li data-sort="scenario type">
                            <span>Scenario Type</span>
                        </li>
                        <li data-sort="duration">
                            <span>Duration</span>
                        </li>
                    </ol>
                </div>
            </div>
            <ol id="scenarios">
            </ol>
        </div>
    </main>
    <script id="json-data"  type="application/json">
        [(${jsonTestData})]
    </script>
    <script defer src="assets/utils.js" type="text/javascript"></script>
    <script defer src="assets/index.js" type="text/javascript"></script>
    <script defer src="assets/tableFilter.js" type="text/javascript"></script>
    <script defer src="assets/summaryUpdater.js" type="text/javascript"></script>
</body>

</html>
